<!DOCTYPE html>
<html lang="en">
{{> fragments/html_header}}

<body>

{{> fragments/top_bar}}

<div class="container browse-layout">

    <!-- ===== LEFT FILTERS SECTION ===== -->
    <aside class="browse-filters">
        <form method="get" action="/browse">
            <!-- always go back to first page when applying filters -->
            <input type="hidden" name="page" value="1">

            <div class="filter-box">
                <label for="title">Title:</label>
                <input type="text"
                       id="title"
                       name="title"
                       class="filter-input"
                       value="{{title}}">
            </div>

            <div class="filter-box">
                <label for="author">Author:</label>
                <input type="text"
                       id="author"
                       name="author"
                       class="filter-input"
                       value="{{author}}">
            </div>

            <div class="filter-box">
                <label for="category">Category:</label>
                <input type="text"
                       id="category"
                       name="category"
                       class="filter-input"
                       value="{{category}}">
            </div>

            <div class="filter-box">
                <label for="minRating">
                    Min Rating:
                    <span id="ratingValue">{{minRating}}</span>
                </label>
                <input type="range"
                       id="minRating"
                       name="minRating"
                       min="0"
                       max="5"
                       step="0.1"
                       value="{{minRating}}">
            </div>

            <div class="filter-box">
                <label for="size">Page Size:</label>
                <select name="size" id="size">
                    <option value="10" {{#sizeIs10}}selected{{/sizeIs10}}>10</option>
                    <option value="20" {{#sizeIs20}}selected{{/sizeIs20}}>20</option>
                    <option value="50" {{#sizeIs50}}selected{{/sizeIs50}}>50</option>
                </select>
            </div>

            <button type="submit" class="filter-button">Apply</button>
        </form>
    </aside>


    <!-- ===== MAIN BOOK GRID ===== -->
    <main class="browse-results">

        <div class="books-grid">
            {{#books}}
                {{> fragments/book}}
            {{/books}}

            {{^books}}
                <p>No books found.</p>
            {{/books}}
        </div>


        <!-- ===== PAGINATION SECTION ===== -->
        <div class="pagination">

            {{#hasPrev}}
                <a class="pagination-button"
                   href="/browse?page={{prevPage}}&size={{size}}&title={{title}}&author={{author}}&category={{category}}&minRating={{minRating}}">
                    &laquo; Prev
                </a>
            {{/hasPrev}}

            {{#pages}}
                <a class="pagination-number {{#current}}active{{/current}}"
                   href="/browse?page={{number}}&size={{size}}&title={{title}}&author={{author}}&category={{category}}&minRating={{minRating}}">
                    {{number}}
                </a>
            {{/pages}}

            {{#hasNext}}
                <a class="pagination-button"
                   href="/browse?page={{nextPage}}&size={{size}}&title={{title}}&author={{author}}&category={{category}}&minRating={{minRating}}">
                    Next &raquo;
                </a>
            {{/hasNext}}

        </div>

    </main>

</div>

{{> fragments/footer}}

<!-- small script to live-update the rating label -->
<script>
  (function () {
    var slider = document.getElementById("minRating");
    var label  = document.getElementById("ratingValue");
    if (slider && label) {
      if (!label.textContent) {
        label.textContent = slider.value || "0";
      }
      slider.addEventListener("input", function () {
        label.textContent = slider.value;
      });
    }
  })();
</script>

</body>
</html>
